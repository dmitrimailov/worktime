# План миграции проекта Work Timer с Kivy на Flet

Этот документ описывает пошаговый процесс переноса приложения с Kivy/Buildozer на Flet.

## Этап 1: Подготовка окружения и структуры проекта

**Цель:** Создать чистое, изолированное окружение для разработки и заложить правильную структуру файлов нового проекта.

### 1.1. Выбор версии Python

*   **Python 3.11:** Стабильная, быстрая и отлично поддерживаемая версия. Flet и все основные библиотеки с ней прекрасно работают. Это наш выбор.
*   **Python 3.12:** Новее, но некоторые библиотеки могут иметь с ней проблемы совместимости. Пока избегаем.
*   **Python 3.13+:** В разработке, для реальных проектов не используется.

**Решение: Используем Python 3.11.**

### 1.2. Создание виртуального окружения (`venv`)

Виртуальное окружение — это "песочница" для нашего проекта, которая изолирует его зависимости от системы и других проектов.

1.  Откройте терминал в папке проекта `/home/dima/Документы/рабвремя/`.
2.  Создайте виртуальное окружение. Назовем его `.venv` (точка в начале скроет папку в файловом менеджере).
    ```bash
    python3.11 -m venv .venv
    ```
3.  Активируйте окружение. После этого в начале строки терминала появится `(.venv)`.
    *   Для Linux/macOS:
        ```bash
        source .venv/bin/activate
        ```
    *   Для Windows (PowerShell):
        ```powershell
        .\.venv\Scripts\Activate.ps1
        ```

### 1.3. Установка Flet

Теперь, когда окружение активно, установим Flet. Все зависимости установятся автоматически.

```bash
pip install flet
```

### 1.4. Новая структура проекта

Старые файлы Kivy (`screens/`, `worktimer.kv` и т.д.) нам больше не нужны. Создадим новую, более простую структуру для Flet-приложения.

```
work_timer_flet/
├── main.py             # Главный файл, точка входа в приложение
├── database.py         # Логика работы с базой данных (перенесем из старого проекта)
├── calculator.py       # Логика расчетов (перенесем из старого проекта)
└── views/              # Папка для UI-компонентов (экранов)
    ├── main_view.py    # Главный экран
    ├── add_edit_view.py # Экран добавления/редактирования записи
    ├── history_view.py # Экран истории и сводки
    └── settings_view.py # Экран настроек
```

**Ваши следующие действия:**
1. Убедитесь, что у вас установлен Python 3.11.
2. Выполните шаги 1.2 и 1.3, чтобы создать и активировать окружение и установить Flet.
3. Создайте новую папку `work_timer_flet` и внутри нее пустые файлы и папки согласно структуре из п. 1.4.

Когда будете готовы, мы перейдем к следующему этапу: переносу существующей логики и созданию базового окна приложения.

+3. Создайте новую папку `work_timer_flet` и внутри нее пустые файлы и папки согласно структуре из п. 1.4.
+
+Когда будете готовы, мы перейдем к следующему этапу: переносу существующей логики и созданию базового окна приложения.

## Этап 2: Перенос логики и создание точки входа

**Цель:** Перенести не-визуальную часть кода (работа с БД, расчеты) и создать базовое окно Flet-приложения.

### 2.1. Перенос бизнес-логики

Ваши старые файлы `database_manager.py` и `calculator.py` не зависят от Kivy. Их можно перенести в новый проект практически без изменений.

1.  **Скопируйте содержимое** вашего старого файла `database/database_manager.py` в новый файл `work_timer_flet/database.py`.
2.  **Скопируйте содержимое** вашего старого файла `screens/calculator.py` (или где он у вас находился) в новый файл `work_timer_flet/calculator.py`.

*Примечание: Эти модули используют только стандартные библиотеки Python (`sqlite3`, `datetime`), поэтому они будут работать в Flet без проблем.*

### 2.2. Создание точки входа (`main.py`)

Это сердце Flet-приложения. В отличие от Kivy, где есть класс `App`, в Flet есть главная функция, обычно `main`.

1.  Откройте ваш новый пустой файл `work_timer_flet/main.py`.
2.  Добавьте в него код для создания простого окна с заголовком. Этот код мы предоставим на следующем шаге.

### 2.3. Первый запуск

После того как `main.py` будет готов, мы сможем впервые запустить наше новое приложение.

1.  Убедитесь, что ваше виртуальное окружение `.venv` активировано.
2.  Выполните в терминале команду:
    ```bash
    flet run work_timer_flet/main.py
    ```

**Ваши следующие действия:**
1. Выполните шаг 2.1: скопируйте код для `database.py` и `calculator.py`.
2. Сообщите мне, когда будете готовы, и мы напишем код для `main.py` и впервые запустим приложение.

